<!doctype html>
<html lang="pt-PT">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Playlist YouTube â€” Background Player</title>
<style>
  body {
  margin: 0;
  background: #000;
  overflow: hidden;
}

/* Iframe em background */
#player-bg {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  pointer-events: none; /* impede cliques no video */
  z-index: -2; /* fica atrÃ¡s */
}

/* Controlo sobre o video */
#controls {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  gap: 15px;
  z-index: 10;
}

#controls button {
  background: #ffffff22;
  color: white;
  border: 1px solid #ffffff44;
  padding: 10px 14px;
  border-radius: 8px;
  font-size: 18px;
  cursor: pointer;
  backdrop-filter: blur(4px);
}

#controls button:hover {
  background: #ffffff44;
}

</style>
</head>
<body>

  <!-- PLAYER EM SEGUNDO PLANO -->
  <div id="player-bg"></div>

  <!-- CONTROLOS SOBREPOSTOS -->
  <div id="controls">
    <button id="btnPrev">â®ï¸</button>
    <button id="btnPlayPause">â¯ï¸</button>
    <button id="btnNext">â­ï¸</button>
    <button id="btnVolDown">ğŸ”‰</button>
    <button id="btnVolUp">ğŸ”Š</button>
  </div>

<script src="https://www.youtube.com/iframe_api"></script>
<script>
  // Lista manual de vÃ­deos â€” debug incluÃ­do
const playlist = [
  "sxlPEZ259jo",
  "Sq0SO-bzHZE",
  "hTWKbfoikeg"
];

let index = 0;
let player;

console.log("[DEBUG] Script carregado. Playlist:", playlist);

// Carregar API
function onYouTubeIframeAPIReady() {
  console.log("[DEBUG] YouTube Iframe API pronta.");

  player = new YT.Player("player-bg", {
    width: "100%",
    height: "100%",
    videoId: playlist[index],
    playerVars: {
      autoplay: 1,
      controls: 0,
      modestbranding: 1,
      rel: 0,
      showinfo: 0,
      mute: 1,
      playsinline: 1
    },
    events: {
      onReady: onReady,
      onStateChange: onStateChange
    }
  });

  console.log("[DEBUG] Player inicializado com videoId:", playlist[index]);
}

function onReady() {
  console.log("[DEBUG] Player READY.");
  console.log("[DEBUG] A iniciar reproduÃ§Ã£o...");
  player.playVideo();

  setupControls();
}

function onStateChange(e) {
  const states = {
    "-1": "UNSTARTED",
    "0": "ENDED",
    "1": "PLAYING",
    "2": "PAUSED",
    "3": "BUFFERING",
    "5": "CUED"
  };

  console.log(`[DEBUG] StateChange â†’ ${states[e.data]} (${e.data})`);

  if (e.data === YT.PlayerState.ENDED) {
    console.log("[DEBUG] Video terminou â†’ avanÃ§ar automaticamente");
    nextVideo();
  }
}

function skipVideo(i) {
  const oldIndex = index;
  index = (index + i + playlist.length) % playlist.length;

  console.log(
    `[DEBUG] Skip video: ${i>0?"Forward":"Backward"} | ${oldIndex} â†’ ${index}`
  );

  console.log("[DEBUG] Carregando videoId:", playlist[index]);
  player.loadVideoById(playlist[index]);
}

function nextVideo() { skipVideo(1); }
function prevVideo() { skipVideo(-1); }

function setupControls() {
  console.log("[DEBUG] Controles configurados.");

  document.getElementById("btnNext").onclick = () => {
    console.log("[DEBUG] BotÃ£o NEXT clicado");
    nextVideo();
  };

  document.getElementById("btnPrev").onclick = () => {
    console.log("[DEBUG] BotÃ£o PREV clicado");
    prevVideo();
  };

  document.getElementById("btnPlayPause").onclick = () => {
    const state = player.getPlayerState();
    console.log("[DEBUG] Play/Pause clicado. Estado atual:", state);

    if (state === YT.PlayerState.PLAYING) {
      console.log("[DEBUG] Pausando vÃ­deo...");
      player.pauseVideo();
    } else {
      console.log("[DEBUG] Reproduzindo vÃ­deo...");
      player.playVideo();
    }
  };

  document.getElementById("btnVolUp").onclick = () => {
    let v = player.getVolume();
    const newV = Math.min(100, v + 10);
    console.log(`[DEBUG] Volume UP: ${v} â†’ ${newV}`);
    player.setVolume(newV);
  };

  document.getElementById("btnVolDown").onclick = () => {
    let v = player.getVolume();
    const newV = Math.max(0, v - 10);
    console.log(`[DEBUG] Volume DOWN: ${v} â†’ ${newV}`);
    player.setVolume(newV);
  };
}

</script>
</body>
</html>
